
SUBROUTINE ACNPART_OPENACC (YDCST, YDML_PHY_MF, KIDIA, KFDIA, KLON, KTDIA, KLEV, PAPHI, PAPHIF,&
& PAPRSF, PDECRD, PNEB, PCLCH, PCLCM, PCLCL, PCLCT, PCLCT_RAD, PCLCC, PNEBC, PTOPC, YDSTACK)
!$acc routine (ACNPART_OPENACC) seq
USE MODEL_PHYSICS_MF_MOD,ONLY:MODEL_PHYSICS_MF_TYPE
USE PARKIND1,ONLY:JPIM, JPRB

USE YOMCST,ONLY:TCST
USE STACK_MOD
#include "stack.h"

IMPLICIT NONE

TYPE (TCST), INTENT (IN)::YDCST
TYPE (MODEL_PHYSICS_MF_TYPE), INTENT (IN)::YDML_PHY_MF
INTEGER (KIND=JPIM), INTENT (IN)::KIDIA
INTEGER (KIND=JPIM), INTENT (IN)::KFDIA
INTEGER (KIND=JPIM), INTENT (IN)::KLON
INTEGER (KIND=JPIM), INTENT (IN)::KTDIA
INTEGER (KIND=JPIM), INTENT (IN)::KLEV
REAL (KIND=JPRB), INTENT (IN)::PAPHI (KLON, 0:KLEV)
REAL (KIND=JPRB), INTENT (IN)::PAPHIF (KLON, KLEV)
REAL (KIND=JPRB), INTENT (IN)::PAPRSF (KLON, KLEV)
REAL (KIND=JPRB), INTENT (IN)::PDECRD (KLON)
REAL (KIND=JPRB), INTENT (IN)::PNEB (KLON, KLEV)
REAL (KIND=JPRB), INTENT (OUT)::PCLCH (KLON)
REAL (KIND=JPRB), INTENT (OUT)::PCLCM (KLON)
REAL (KIND=JPRB), INTENT (OUT)::PCLCL (KLON)
REAL (KIND=JPRB), INTENT (OUT)::PCLCT (KLON)
REAL (KIND=JPRB), INTENT (OUT)::PCLCT_RAD (KLON)
REAL (KIND=JPRB), INTENT (OUT), OPTIONAL::PCLCC (KLON)
REAL (KIND=JPRB), INTENT (IN), OPTIONAL::PNEBC (KLON, KLEV)
REAL (KIND=JPRB), INTENT (OUT), OPTIONAL::PTOPC (KLON)
TYPE(STACK) :: YDSTACK
TYPE(STACK) :: YLSTACK
#include "acnpart_cloud_cover_wmo_openacc.intfb.h"
#include "acnpart_cloud_cover_openacc.intfb.h"
#include "acnpart_conv_base_top_openacc.intfb.h"

REAL (KIND=JPRB)::ZWMXOV
REAL (KIND=JPRB)::ZDECRDRED

INTEGER (KIND=JPIM) :: JLON

YLSTACK = YDSTACK




JLON = KIDIA


ZDECRDRED=YDML_PHY_MF%YRPHY0%RDECRDRED
ZWMXOV=YDML_PHY_MF%YRPHY0%WMXOV

IF (YDML_PHY_MF%YRPHY2%LWMOCLOUD) THEN
  CALL ACNPART_CLOUD_COVER_WMO_OPENACC (YDCST, YDML_PHY_MF, KIDIA, KFDIA, KLON, KTDIA, KLEV,&
  & ZDECRDRED, ZWMXOV, PDECRD, PNEB, PAPHI, PAPRSF, PCLCH, PCLCM, PCLCL, YDSTACK=YLSTACK)
ELSE
  CALL ACNPART_CLOUD_COVER_OPENACC (YDCST, YDML_PHY_MF, KIDIA, KFDIA, KLON, KTDIA, KLEV, ZDECRDRED&
  &, ZWMXOV, KTDIA, YDML_PHY_MF%YRPHY2%NTSHM, PDECRD, PNEB, PAPRSF, PCLCH, YDSTACK=YLSTACK)
  CALL ACNPART_CLOUD_COVER_OPENACC (YDCST, YDML_PHY_MF, KIDIA, KFDIA, KLON&
  &, KTDIA, KLEV, ZDECRDRED, ZWMXOV, YDML_PHY_MF%YRPHY2%NTSHM+1, YDML_PHY_MF&
  &%YRPHY2%NTSML, PDECRD, PNEB, PAPRSF, PCLCM, YDSTACK=YLSTACK)
  CALL ACNPART_CLOUD_COVER_OPENACC (YDCST, YDML_PHY_MF, KIDIA, KFDIA, KLON, KTDIA, KLEV, ZDECRDRED&
  &, ZWMXOV, YDML_PHY_MF%YRPHY2%NTSML+1, KLEV, PDECRD, PNEB, PAPRSF, PCLCL, YDSTACK=YLSTACK)
ENDIF

CALL ACNPART_CLOUD_COVER_OPENACC (YDCST, YDML_PHY_MF, KIDIA, KFDIA, KLON, KTDIA, KLEV&
&, ZDECRDRED, ZWMXOV, KTDIA, KLEV, PDECRD, PNEB, PAPRSF, PCLCT, YDSTACK=YLSTACK)

IF (PRESENT (PCLCC)) THEN
  CALL ACNPART_CLOUD_COVER_OPENACC (YDCST, YDML_PHY_MF, KIDIA, KFDIA, KLON, KTDIA, KLEV&
  &, ZDECRDRED, ZWMXOV, KTDIA, KLEV, PDECRD, PNEBC, PAPRSF, PCLCC, YDSTACK=YLSTACK)
ENDIF


IF (YDML_PHY_MF%YRPHY%LRNUMX.AND.(YDML_PHY_MF%YRPHY%LACPANMX.OR.YDML_PHY_MF%YRPHY%LRNUEXP)) THEN
  ZDECRDRED=1._JPRB
  ZWMXOV=1._JPRB
  CALL ACNPART_CLOUD_COVER_OPENACC (YDCST, YDML_PHY_MF, KIDIA, KFDIA, KLON, KTDIA, KLEV,&
  & ZDECRDRED, ZWMXOV, KTDIA, KLEV, PDECRD, PNEB, PAPRSF, PCLCT_RAD, YDSTACK=YLSTACK)
ELSE
  PCLCT_RAD (JLON)=PCLCT (JLON)
ENDIF


IF (PRESENT (PTOPC).AND.YDML_PHY_MF%YRPHY%LPTOPC) THEN
  CALL ACNPART_CONV_BASE_TOP_OPENACC (YDCST, YDML_PHY_MF, KIDIA, KFDIA,&
  & KLON, KTDIA, KLEV, PNEBC, PAPRSF, PAPHIF, PTOPC, YDSTACK=YLSTACK)
ENDIF



ENDSUBROUTINE

! 56ad6923076b622f9a4a36289517d0f4b37156a2
